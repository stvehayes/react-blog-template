{"ast":null,"code":"import { invariant } from 'hey-listen';\nvar prevTime = 0;\nvar onNextFrame = typeof window !== 'undefined' && window.requestAnimationFrame !== undefined ? function (callback) {\n  return window.requestAnimationFrame(callback);\n} : function (callback) {\n  var timestamp = Date.now();\n  var timeToCall = Math.max(0, 16.7 - (timestamp - prevTime));\n  prevTime = timestamp + timeToCall;\n  setTimeout(function () {\n    return callback(prevTime);\n  }, timeToCall);\n};\n\nvar createStep = function (setRunNextFrame) {\n  var processToRun = [];\n  var processToRunNextFrame = [];\n  var numThisFrame = 0;\n  var isProcessing = false;\n  var i = 0;\n  var cancelled = new WeakSet();\n  var toKeepAlive = new WeakSet();\n  var renderStep = {\n    cancel: function (process) {\n      var indexOfCallback = processToRunNextFrame.indexOf(process);\n      cancelled.add(process);\n\n      if (indexOfCallback !== -1) {\n        processToRunNextFrame.splice(indexOfCallback, 1);\n      }\n    },\n    process: function (frame) {\n      var _a;\n\n      isProcessing = true;\n      _a = [processToRunNextFrame, processToRun], processToRun = _a[0], processToRunNextFrame = _a[1];\n      processToRunNextFrame.length = 0;\n      numThisFrame = processToRun.length;\n\n      if (numThisFrame) {\n        var process_1;\n\n        for (i = 0; i < numThisFrame; i++) {\n          process_1 = processToRun[i];\n          process_1(frame);\n\n          if (toKeepAlive.has(process_1) === true && !cancelled.has(process_1)) {\n            renderStep.schedule(process_1);\n            setRunNextFrame(true);\n          }\n        }\n      }\n\n      isProcessing = false;\n    },\n    schedule: function (process, keepAlive, immediate) {\n      if (keepAlive === void 0) {\n        keepAlive = false;\n      }\n\n      if (immediate === void 0) {\n        immediate = false;\n      }\n\n      invariant(typeof process === \"function\", \"Argument must be a function\");\n      var addToCurrentBuffer = immediate && isProcessing;\n      var buffer = addToCurrentBuffer ? processToRun : processToRunNextFrame;\n      cancelled.delete(process);\n      if (keepAlive) toKeepAlive.add(process);\n\n      if (buffer.indexOf(process) === -1) {\n        buffer.push(process);\n        if (addToCurrentBuffer) numThisFrame = processToRun.length;\n      }\n    }\n  };\n  return renderStep;\n};\n\nvar maxElapsed = 40;\nvar defaultElapsed = 1 / 60 * 1000;\nvar useDefaultElapsed = true;\nvar willRunNextFrame = false;\nvar isProcessing = false;\nvar frame = {\n  delta: 0,\n  timestamp: 0\n};\nvar stepsOrder = [\"read\", \"update\", \"preRender\", \"render\", \"postRender\"];\n\nvar setWillRunNextFrame = function (willRun) {\n  return willRunNextFrame = willRun;\n};\n\nvar steps = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n  acc[key] = createStep(setWillRunNextFrame);\n  return acc;\n}, {});\nvar sync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n  var step = steps[key];\n\n  acc[key] = function (process, keepAlive, immediate) {\n    if (keepAlive === void 0) {\n      keepAlive = false;\n    }\n\n    if (immediate === void 0) {\n      immediate = false;\n    }\n\n    if (!willRunNextFrame) startLoop();\n    step.schedule(process, keepAlive, immediate);\n    return process;\n  };\n\n  return acc;\n}, {});\nvar cancelSync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n  acc[key] = steps[key].cancel;\n  return acc;\n}, {});\n\nvar processStep = function (stepId) {\n  return steps[stepId].process(frame);\n};\n\nvar processFrame = function (timestamp) {\n  willRunNextFrame = false;\n  frame.delta = useDefaultElapsed ? defaultElapsed : Math.max(Math.min(timestamp - frame.timestamp, maxElapsed), 1);\n  if (!useDefaultElapsed) defaultElapsed = frame.delta;\n  frame.timestamp = timestamp;\n  isProcessing = true;\n  stepsOrder.forEach(processStep);\n  isProcessing = false;\n\n  if (willRunNextFrame) {\n    useDefaultElapsed = false;\n    onNextFrame(processFrame);\n  }\n};\n\nvar startLoop = function () {\n  willRunNextFrame = true;\n  useDefaultElapsed = true;\n  if (!isProcessing) onNextFrame(processFrame);\n};\n\nvar getFrameData = function () {\n  return frame;\n};\n\nexport default sync;\nexport { cancelSync, getFrameData };","map":{"version":3,"sources":["/Users/steve/Desktop/repos/react-blog-template/node_modules/framesync/dist/framesync.es.js"],"names":["invariant","prevTime","onNextFrame","window","requestAnimationFrame","undefined","callback","timestamp","Date","now","timeToCall","Math","max","setTimeout","createStep","setRunNextFrame","processToRun","processToRunNextFrame","numThisFrame","isProcessing","i","cancelled","WeakSet","toKeepAlive","renderStep","cancel","process","indexOfCallback","indexOf","add","splice","frame","_a","length","process_1","has","schedule","keepAlive","immediate","addToCurrentBuffer","buffer","delete","push","maxElapsed","defaultElapsed","useDefaultElapsed","willRunNextFrame","delta","stepsOrder","setWillRunNextFrame","willRun","steps","reduce","acc","key","sync","step","startLoop","cancelSync","processStep","stepId","processFrame","min","forEach","getFrameData"],"mappings":"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","sourcesContent":["import { invariant } from 'hey-listen';\n\nvar prevTime = 0;\nvar onNextFrame = typeof window !== 'undefined' && window.requestAnimationFrame !== undefined ? function (callback) {\n    return window.requestAnimationFrame(callback);\n} : function (callback) {\n    var timestamp = Date.now();\n    var timeToCall = Math.max(0, 16.7 - (timestamp - prevTime));\n    prevTime = timestamp + timeToCall;\n    setTimeout(function () {\n        return callback(prevTime);\n    }, timeToCall);\n};\n\nvar createStep = function (setRunNextFrame) {\n    var processToRun = [];\n    var processToRunNextFrame = [];\n    var numThisFrame = 0;\n    var isProcessing = false;\n    var i = 0;\n    var cancelled = new WeakSet();\n    var toKeepAlive = new WeakSet();\n    var renderStep = {\n        cancel: function (process) {\n            var indexOfCallback = processToRunNextFrame.indexOf(process);\n            cancelled.add(process);\n            if (indexOfCallback !== -1) {\n                processToRunNextFrame.splice(indexOfCallback, 1);\n            }\n        },\n        process: function (frame) {\n            var _a;\n            isProcessing = true;\n            _a = [processToRunNextFrame, processToRun], processToRun = _a[0], processToRunNextFrame = _a[1];\n            processToRunNextFrame.length = 0;\n            numThisFrame = processToRun.length;\n            if (numThisFrame) {\n                var process_1;\n                for (i = 0; i < numThisFrame; i++) {\n                    process_1 = processToRun[i];\n                    process_1(frame);\n                    if (toKeepAlive.has(process_1) === true && !cancelled.has(process_1)) {\n                        renderStep.schedule(process_1);\n                        setRunNextFrame(true);\n                    }\n                }\n            }\n            isProcessing = false;\n        },\n        schedule: function (process, keepAlive, immediate) {\n            if (keepAlive === void 0) {\n                keepAlive = false;\n            }\n            if (immediate === void 0) {\n                immediate = false;\n            }\n            invariant(typeof process === \"function\", \"Argument must be a function\");\n            var addToCurrentBuffer = immediate && isProcessing;\n            var buffer = addToCurrentBuffer ? processToRun : processToRunNextFrame;\n            cancelled.delete(process);\n            if (keepAlive) toKeepAlive.add(process);\n            if (buffer.indexOf(process) === -1) {\n                buffer.push(process);\n                if (addToCurrentBuffer) numThisFrame = processToRun.length;\n            }\n        }\n    };\n    return renderStep;\n};\n\nvar maxElapsed = 40;\nvar defaultElapsed = 1 / 60 * 1000;\nvar useDefaultElapsed = true;\nvar willRunNextFrame = false;\nvar isProcessing = false;\nvar frame = {\n    delta: 0,\n    timestamp: 0\n};\nvar stepsOrder = [\"read\", \"update\", \"preRender\", \"render\", \"postRender\"];\nvar setWillRunNextFrame = function (willRun) {\n    return willRunNextFrame = willRun;\n};\nvar steps = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    acc[key] = createStep(setWillRunNextFrame);\n    return acc;\n}, {});\nvar sync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    var step = steps[key];\n    acc[key] = function (process, keepAlive, immediate) {\n        if (keepAlive === void 0) {\n            keepAlive = false;\n        }\n        if (immediate === void 0) {\n            immediate = false;\n        }\n        if (!willRunNextFrame) startLoop();\n        step.schedule(process, keepAlive, immediate);\n        return process;\n    };\n    return acc;\n}, {});\nvar cancelSync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    acc[key] = steps[key].cancel;\n    return acc;\n}, {});\nvar processStep = function (stepId) {\n    return steps[stepId].process(frame);\n};\nvar processFrame = function (timestamp) {\n    willRunNextFrame = false;\n    frame.delta = useDefaultElapsed ? defaultElapsed : Math.max(Math.min(timestamp - frame.timestamp, maxElapsed), 1);\n    if (!useDefaultElapsed) defaultElapsed = frame.delta;\n    frame.timestamp = timestamp;\n    isProcessing = true;\n    stepsOrder.forEach(processStep);\n    isProcessing = false;\n    if (willRunNextFrame) {\n        useDefaultElapsed = false;\n        onNextFrame(processFrame);\n    }\n};\nvar startLoop = function () {\n    willRunNextFrame = true;\n    useDefaultElapsed = true;\n    if (!isProcessing) onNextFrame(processFrame);\n};\nvar getFrameData = function () {\n    return frame;\n};\n\nexport default sync;\nexport { cancelSync, getFrameData };\n"]},"metadata":{},"sourceType":"module"}